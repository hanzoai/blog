1:"$Sreact.fragment"
2:I[2710,["933","static/chunks/933-166e0fcc9496c98f.js","177","static/chunks/app/layout-47e4a7ab857a36d7.js"],"ThemeProvider"]
3:I[9933,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"Image"]
4:I[3977,[],""]
5:I[8765,[],""]
6:I[4526,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"FlickeringGrid"]
7:I[1964,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],""]
9:I[2463,[],"OutletBoundary"]
c:I[373,[],"AsyncMetadataOutlet"]
e:I[2463,[],"ViewportBoundary"]
10:I[2463,[],"MetadataBoundary"]
12:I[680,[],""]
:HL["/_next/static/media/27834908180db20f-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/78fec81b34c4a365.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/5ecf9fcd3bbfeb13.css","style"]
0:{"P":null,"b":"Szp5DJTNL0ohTsfq4PNfU","p":"","c":["","blog","2024-04-10-qzmq-protocol"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","2024-04-10-qzmq-protocol","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5ecf9fcd3bbfeb13.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"__variable_245d8d __variable_97c177 antialiased","suppressHydrationWarning":true,"children":["$","body",null,{"children":["$","$L2",null,{"attribute":"class","defaultTheme":"dark","enableSystem":true,"disableTransitionOnChange":true,"children":[["$","header",null,{"className":"border-b border-border/50 px-6 py-4 sticky top-0 z-20 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60","children":["$","div",null,{"className":"max-w-5xl mx-auto flex items-center justify-between","children":[["$","a",null,{"href":"https://hanzo.ai","className":"flex items-center gap-2 text-foreground hover:opacity-80 transition-opacity","children":[["$","$L3",null,{"src":"/hanzo-logo.svg","alt":"Hanzo","width":20,"height":20,"className":"dark:invert-0 invert"}],["$","span",null,{"className":"font-semibold text-base tracking-tight","children":"hanzo"}],["$","span",null,{"className":"text-muted-foreground text-sm","children":"/ blog"}]]}],["$","nav",null,{"className":"flex items-center gap-4 text-sm text-muted-foreground","children":[["$","a",null,{"href":"https://hanzo.ai","className":"hover:text-foreground transition-colors","children":"hanzo.ai"}],["$","a",null,{"href":"https://hanzo.help","className":"hover:text-foreground transition-colors hidden sm:block","children":"Help"}],["$","a",null,{"href":"https://discord.gg/hanzo","target":"_blank","rel":"noopener noreferrer","className":"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border text-foreground hover:bg-accent transition-all text-sm font-medium","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-message-circle h-3.5 w-3.5","aria-hidden":"true","children":[["$","path","vv11sd",{"d":"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"}],"$undefined"]}],"Discord"]}]]}]]}]}],["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"min-h-screen bg-background flex items-center justify-center w-full z-10","children":[["$","div",null,{"className":"absolute top-0 left-0 z-0 w-full h-[500px] [mask-image:linear-gradient(to_top,transparent_25%,black_95%)]","children":["$","$L6",null,{"className":"absolute top-0 left-0 size-full","squareSize":4,"gridGap":6,"color":"#6B7280","maxOpacity":0.5,"flickerChance":0.1}]}],["$","div",null,{"className":"text-center flex flex-col gap-4 max-w-xs mx-auto relative","children":[["$","h1",null,{"className":"text-8xl font-mono font-bold drop-shadow-lg text-primary","children":"404"}],["$","p",null,{"className":"text-muted-foreground text-base leading-relaxed text-center tracking-tight text-balance","children":"Sorry, we couldn't find the page you're looking for. The page might have been moved, deleted, or you entered the wrong URL."}],["$","$L7",null,{"href":"/","children":"Back to Home","className":"inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 px-4 py-2 has-[>svg]:px-3 w-full rounded-lg h-9 drop-shadow-lg","ref":null}]]}]]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","footer",null,{"className":"border-t border-border/50 px-6 py-6 mt-auto","children":["$","div",null,{"className":"max-w-5xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-muted-foreground","children":[["$","div",null,{"className":"flex items-center gap-2","children":[["$","$L3",null,{"src":"/hanzo-logo.svg","alt":"Hanzo","width":16,"height":16,"className":"dark:invert-0 invert opacity-50"}],["$","span",null,{"children":"© 2025 Hanzo AI, Inc. Techstars '17."}]]}],["$","div",null,{"className":"flex items-center gap-4","children":[["$","a",null,{"href":"https://hanzo.ai/privacy","className":"hover:text-foreground transition-colors","children":"Privacy"}],["$","a",null,{"href":"https://hanzo.ai/terms","className":"hover:text-foreground transition-colors","children":"Terms"}],["$","a",null,{"href":"https://hanzo.ai/contact","className":"hover:text-foreground transition-colors","children":"Contact"}],["$","a",null,{"href":"https://github.com/hanzoai","target":"_blank","rel":"noopener noreferrer","className":"hover:text-foreground transition-colors","children":"GitHub"}]]}]]}]}]]}]}]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","2024-04-10-qzmq-protocol","d"],["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L8",null,["$","$L9",null,{"children":["$La","$Lb",["$","$Lc",null,{"promise":"$@d"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","PNqso9IO67U3MBkNSisSdv",{"children":[["$","$Le",null,{"children":"$Lf"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],["$","$L10",null,{"children":"$L11"}]]}],false]],"m":"$undefined","G":["$12","$undefined"],"s":false,"S":true}
13:"$Sreact.suspense"
14:I[373,[],"AsyncMetadata"]
16:I[9048,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"HashScrollHandler"]
17:I[4170,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"CopyHeader"]
18:I[4255,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"CodeBlock"]
19:I[4255,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"Pre"]
1a:I[9372,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"TableOfContents"]
1b:I[1413,["771","static/chunks/771-2096a43097a1ac56.js","933","static/chunks/933-166e0fcc9496c98f.js","698","static/chunks/698-980099c394b58d6f.js","218","static/chunks/218-3bb2d990159730f8.js","953","static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js"],"MobileTableOfContents"]
11:["$","div",null,{"hidden":true,"children":["$","$13",null,{"fallback":null,"children":["$","$L14",null,{"promise":"$@15"}]}]}]
8:["$","div",null,{"className":"min-h-screen bg-background relative","children":[["$","$L16",null,{}],["$","div",null,{"className":"absolute top-0 left-0 z-0 w-full h-[200px] [mask-image:linear-gradient(to_top,transparent_25%,black_95%)]","children":["$","$L6",null,{"className":"absolute top-0 left-0 size-full","squareSize":4,"gridGap":6,"color":"#6B7280","maxOpacity":0.2,"flickerChance":0.05}]}],["$","div",null,{"className":"space-y-4 border-b border-border relative z-10","children":["$","div",null,{"className":"max-w-7xl mx-auto flex flex-col gap-6 p-6","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-3 gap-y-5 text-sm text-muted-foreground","children":[["$","$L7",null,{"href":"/","children":[["$","svg",null,{"ref":"$undefined","xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left w-4 h-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],["$","span",null,{"className":"sr-only","children":"Back to all articles"}]],"className":"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[>svg]:px-3 h-6 w-6","ref":null}],["$","div",null,{"className":"flex flex-wrap gap-3 text-muted-foreground","children":[["$","span","qzmq",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"qzmq"}],["$","span","post-quantum",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"post-quantum"}],["$","span","transport",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"transport"}],["$","span","kdf",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"kdf"}],["$","span","key-schedule",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"key-schedule"}],["$","span","protocol-design",{"className":"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center","children":"protocol-design"}]]}],["$","time",null,{"className":"font-medium text-muted-foreground","children":"April 9, 2024"}]]}],["$","h1",null,{"className":"text-4xl md:text-5xl lg:text-6xl font-medium tracking-tighter text-balance","children":"QZMQ: A Post-Quantum Transport Protocol"}],["$","p",null,{"className":"text-muted-foreground max-w-4xl md:text-lg md:text-balance","children":"QZMQ key schedule: HKDF-labeled QZMQ-v1-Handshake, client/server key+IV derivation, exporter secret, key ratcheting, 0-RTT early data, resumption secrets, and key usage budgets. Why a custom PQ transport."}]]}]}],["$","div",null,{"className":"flex divide-x divide-border relative max-w-7xl mx-auto px-4 md:px-0 z-10","children":[["$","div",null,{"className":"absolute max-w-7xl mx-auto left-1/2 -translate-x-1/2 w-[calc(100%-2rem)] lg:w-full h-full border-x border-border p-0 pointer-events-none"}],["$","main",null,{"className":"w-full p-0 overflow-hidden","children":[null,["$","div",null,{"className":"p-6 lg:p-10","children":["$","div",null,{"className":"prose dark:prose-invert max-w-none prose-headings:scroll-mt-8 prose-headings:font-semibold prose-a:no-underline prose-headings:tracking-tight prose-headings:text-balance prose-p:tracking-tight prose-p:text-balance prose-lg","children":["$","div",null,{"ref":"$undefined","children":[["$","p",null,{"children":"QZMQ is a custom post-quantum transport protocol. It is not TLS 1.3 with a PQ extension. It is a transport designed from scratch with post-quantum key exchange as a first principle rather than a retrofit."}],"\n",["$","p",null,{"children":"The key schedule is where protocol design becomes concrete. Here is how QZMQ derives its working key material."}],"\n",["$","$L17",null,{"level":2,"id":"the-handshake-label","children":"The Handshake Label"}],"\n",["$","p",null,{"children":["The master secret derivation uses HKDF with the label ",["$","code",null,{"children":"QZMQ-v1-Handshake"}],". HKDF's structure is extract-then-expand:"]}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Extract"}],": Combine the input key material (the hybrid X25519+ML-KEM shared secret) with a salt to produce a pseudorandom key (PRK). The PRK has high entropy even if the IKM has low entropy."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Expand"}],": Derive arbitrarily many bytes from the PRK using labeled HKDF-Expand calls. Each label produces an independent, indistinguishable-from-random output."]}],"\n"]}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"QZMQ-v1-Handshake"}]," label anchors the entire key schedule to this specific protocol and version. A key derived under this label cannot be confused with a key derived under any other label or for any other protocol."]}],"\n",["$","$L17",null,{"level":2,"id":"key-and-iv-derivation","children":"Key and IV Derivation"}],"\n",["$","p",null,{"children":"From the handshake PRK, QZMQ derives separate keys and initialization vectors for each direction:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","code",null,{"children":"QZMQ-v1-ClientKey"}],": symmetric encryption key for client→server traffic"]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"QZMQ-v1-ClientIV"}],": IV for client→server traffic"]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"QZMQ-v1-ServerKey"}],": symmetric encryption key for server→client traffic"]}],"\n",["$","li",null,{"children":[["$","code",null,{"children":"QZMQ-v1-ServerIV"}],": IV for server→client traffic"]}],"\n"]}],"\n",["$","p",null,{"children":"The separation of keys and IVs by direction means a server key compromise does not compromise client→server confidentiality, and vice versa. Directional keys are a baseline transport security requirement."}],"\n",["$","$L17",null,{"level":2,"id":"exporter-secret","children":"Exporter Secret"}],"\n",["$","p",null,{"children":"The exporter secret allows application-layer protocols layered over QZMQ to derive their own key material bound to the specific QZMQ session:"}],"\n",["$","$L18",null,{"className":"shiki shiki-themes github-light github-dark","style":{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},"tabIndex":"0","icon":"<svg viewBox=\"0 0 24 24\"><path d=\"M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z\" fill=\"currentColor\" /></svg>","children":["$","$L19",null,{"children":["$","code",null,{"children":["$","span",null,{"className":"line","children":["$","span",null,{"children":"exporter_secret = HKDF-Expand(PRK, \"QZMQ-v1-Exporter\", session_context)"}]}]}]}]}],"\n",["$","p",null,{"children":["An application can call ",["$","code",null,{"children":"Export(label, length)"}]," and receive key material that is bound to this session and this label. Two different applications using two different labels get independent, cryptographically separated key material from the same QZMQ session. This is the mechanism TLS 1.3 uses for exporters; QZMQ implements the same pattern."]}],"\n",["$","$L17",null,{"level":2,"id":"key-ratcheting","children":"Key Ratcheting"}],"\n",["$","p",null,{"children":"After the handshake, keys are ratcheted. Each message updates the session key state:"}],"\n",["$","$L18",null,{"className":"shiki shiki-themes github-light github-dark","style":{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},"tabIndex":"0","icon":"<svg viewBox=\"0 0 24 24\"><path d=\"M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z\" fill=\"currentColor\" /></svg>","children":["$","$L19",null,{"children":["$","code",null,{"children":["$","span",null,{"className":"line","children":["$","span",null,{"children":"next_key = HKDF-Expand(current_key, \"QZMQ-v1-Ratchet\", message_counter)"}]}]}]}]}],"\n",["$","p",null,{"children":"Ratcheting provides forward secrecy at the message level: compromising a key at message N does not compromise messages 1 through N-1, whose keys have already been ratcheted forward. After a key is used, it is derived forward and the old value is erased."}],"\n",["$","$L17",null,{"level":2,"id":"0-rtt-early-data","children":"0-RTT Early Data"}],"\n",["$","p",null,{"children":["QZMQ supports 0-RTT early data using a resumption mechanism. A client with a previous session ticket can send data encrypted under early data keys on the first message, before the handshake completes. The early data label is ",["$","code",null,{"children":"QZMQ-v1-EarlyData"}],"."]}],"\n",["$","p",null,{"children":"0-RTT early data has a known limitation: it is vulnerable to replay attacks. An adversary who captures a 0-RTT message can resend it. QZMQ handles this through application-layer idempotency requirements on operations that accept 0-RTT data. The protocol documents which operation types are safe for 0-RTT and which require the full handshake."}],"\n",["$","$L17",null,{"level":2,"id":"resumption-secrets","children":"Resumption Secrets"}],"\n",["$","p",null,{"children":"Session tickets enable 0-RTT on subsequent connections. The resumption secret:"}],"\n",["$","$L18",null,{"className":"shiki shiki-themes github-light github-dark","style":{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},"tabIndex":"0","icon":"<svg viewBox=\"0 0 24 24\"><path d=\"M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z\" fill=\"currentColor\" /></svg>","children":["$","$L19",null,{"children":["$","code",null,{"children":["$","span",null,{"className":"line","children":["$","span",null,{"children":"resumption_secret = HKDF-Expand(master_secret, \"QZMQ-v1-Resumption\", session_hash)"}]}]}]}]}],"\n",["$","p",null,{"children":"The session hash binds the resumption secret to the specific handshake transcript. A ticket forged without completing a real handshake cannot produce a valid resumption secret."}],"\n",["$","$L17",null,{"level":2,"id":"key-usage-budgets","children":"Key Usage Budgets"}],"\n",["$","p",null,{"children":"QZMQ enforces key usage budgets per session key:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Max messages"}],": a session key is rotated after a configured number of messages, regardless of byte volume"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Max bytes"}],": a session key is rotated after a configured number of bytes encrypted"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Max age"}],": a session key is rotated after a configured time duration"]}],"\n"]}],"\n",["$","p",null,{"children":"When any budget is reached, a key update is triggered. The protocol requires the peer to acknowledge the key update before the session continues. Sessions that exceed a budget without update are terminated."}],"\n",["$","p",null,{"children":"Key usage budgets prevent the cryptographic weaknesses that arise from encrypting too much data under a single key — nonce reuse risks with nonce-based AEADs, statistical attacks on large ciphertext volumes."}],"\n",["$","$L17",null,{"level":2,"id":"why-not-tls-13","children":"Why Not TLS 1.3"}],"\n",["$","p",null,{"children":"TLS 1.3 is adding PQ support through extension mechanisms. IETF drafts for hybrid key exchange in TLS are in progress. The extension approach is correct for the general internet."}],"\n",["$","p",null,{"children":"QZMQ is designed for Lux Network node-to-node communication where we control both endpoints. Designing the key schedule from scratch allowed decisions — the ratchet interval, the budget structure, the exporter interface — to be made for this specific use case rather than accommodating the full generality of the TLS ecosystem."}],"\n",["$","p",null,{"children":["The ",["$","code",null,{"children":"QZMQ-v1-*"}]," label namespace makes the protocol fully versioned and self-describing. When ",["$","code",null,{"children":"QZMQ-v2"}]," is needed, no labels from v1 are reused."]}]],"className":"prose"}]}]}],["$","div",null,{"className":"mt-10","children":["$","section",null,{"className":"border-t border-border p-0","children":["$","div",null,{"className":"p-6 lg:p-10","children":[["$","h2",null,{"className":"text-2xl font-medium mb-8","children":"Read more"}],["$","div",null,{"className":"flex flex-col gap-8","children":[["$","$L7","/blog/2024-07-15-nist-pqc-fips",{"href":"/blog/2024-07-15-nist-pqc-fips","className":"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer","children":["$undefined",["$","div",null,{"className":"space-y-2 flex-1 col-span-1 lg:col-span-8","children":[["$","h3",null,{"className":"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2","children":"NIST FIPS 203/204/205: ML-KEM, ML-DSA, SLH-DSA in Production"}],["$","p",null,{"className":"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4","children":"The Hanzo Rust crypto library implements ML-KEM-512/768/1024, ML-DSA-44/65/87, and HQC-128/192/256 with deny(unsafe_code), ZeroizeOnDrop on all secrets, SecurityLevel enum, and hybrid KE with the HANZO_HYBRID_KE_v1 domain separator."}],["$","time",null,{"className":"block text-xs font-medium text-muted-foreground","children":"July 14, 2024"}]]}]]}],["$","$L7","/blog/2023-12-01-evm-pq-precompiles",{"href":"/blog/2023-12-01-evm-pq-precompiles","className":"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer","children":["$undefined",["$","div",null,{"className":"space-y-2 flex-1 col-span-1 lg:col-span-8","children":[["$","h3",null,{"className":"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2","children":"Post-Quantum EVM Precompiles: ML-DSA, ML-KEM, SLH-DSA at 0x0110"}],["$","p",null,{"className":"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4","children":"Post-quantum EVM precompiles in the Lux Network: ML-DSA at 0x0110-0x0119, ML-KEM at 0x0120-0x0129, SLH-DSA at 0x0130-0x0139, SHAKE at 0x0140-0x0149, Lamport at 0x0150-0x0159. Why precompiles are the right architecture for PQ crypto in EVM."}],["$","time",null,{"className":"block text-xs font-medium text-muted-foreground","children":"November 30, 2023"}]]}]]}],["$","$L7","/blog/2023-06-20-post-quantum-hybrid",{"href":"/blog/2023-06-20-post-quantum-hybrid","className":"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer","children":["$undefined",["$","div",null,{"className":"space-y-2 flex-1 col-span-1 lg:col-span-8","children":[["$","h3",null,{"className":"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2","children":"Hybrid Post-Quantum Cryptography: X25519 + ML-KEM in Production"}],["$","p",null,{"className":"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4","children":"Why hybrid classical+PQ constructions are the right approach, the HKDF-SHA256 combination with the QZMQ-HybridKEM-v1 salt, ML-KEM-768 (FIPS 203) parameters, and the HANZO_HYBRID_KE_v1 domain separator in Rust."}],["$","time",null,{"className":"block text-xs font-medium text-muted-foreground","children":"June 19, 2023"}]]}]]}]]}]]}]}]}]]}],["$","aside",null,{"className":"hidden lg:block w-[350px] flex-shrink-0 p-6 lg:p-10 bg-muted/60 dark:bg-muted/20","children":["$","div",null,{"className":"sticky top-20 space-y-8","children":[["$","div",null,{"className":"flex items-start gap-2","children":["$","div",null,{"className":"flex-1","children":["$","h3",null,{"className":"text-sm tracking-tight text-balance font-semibold","children":"Hanzo AI"}]}]}],["$","div",null,{"className":"border border-border rounded-lg p-6 bg-card","children":["$","$L1a",null,{}]}]]}]}]]}],["$","$L1b",null,{}]]}]
b:null
f:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","2",{"name":"theme-color","content":"black"}]]
a:null
d:{"metadata":[["$","title","0",{"children":"QZMQ: A Post-Quantum Transport Protocol - Hanzo Blog"}],["$","meta","1",{"name":"description","content":"QZMQ key schedule: HKDF-labeled QZMQ-v1-Handshake, client/server key+IV derivation, exporter secret, key ratcheting, 0-RTT early data, resumption secrets, and key usage budgets. Why a custom PQ transport."}],["$","link","2",{"rel":"author","href":"https://blog.hanzo.ai"}],["$","meta","3",{"name":"author","content":"Hanzo AI"}],["$","meta","4",{"name":"keywords","content":"QZMQ: A Post-Quantum Transport Protocol,qzmq,post-quantum,transport,kdf,key-schedule,protocol-design,Hanzo AI,Blog,AI Research,Infrastructure"}],["$","meta","5",{"name":"creator","content":"Hanzo AI"}],["$","meta","6",{"name":"publisher","content":"Hanzo AI"}],["$","meta","7",{"name":"robots","content":"index, follow"}],["$","meta","8",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","9",{"rel":"canonical","href":"https://blog.hanzo.ai/blog/2024-04-10-qzmq-protocol"}],["$","meta","10",{"property":"og:title","content":"QZMQ: A Post-Quantum Transport Protocol"}],["$","meta","11",{"property":"og:description","content":"QZMQ key schedule: HKDF-labeled QZMQ-v1-Handshake, client/server key+IV derivation, exporter secret, key ratcheting, 0-RTT early data, resumption secrets, and key usage budgets. Why a custom PQ transport."}],["$","meta","12",{"property":"og:url","content":"https://blog.hanzo.ai/blog/2024-04-10-qzmq-protocol"}],["$","meta","13",{"property":"og:site_name","content":"Hanzo Blog"}],["$","meta","14",{"property":"og:image","content":"https://blog.hanzo.ai/blog/2024-04-10-qzmq-protocol/opengraph-image"}],["$","meta","15",{"property":"og:image:width","content":"1200"}],["$","meta","16",{"property":"og:image:height","content":"630"}],["$","meta","17",{"property":"og:image:alt","content":"QZMQ: A Post-Quantum Transport Protocol"}],["$","meta","18",{"property":"og:type","content":"article"}],["$","meta","19",{"property":"article:published_time","content":"2024-04-10"}],["$","meta","20",{"property":"article:author","content":"Hanzo AI"}],["$","meta","21",{"property":"article:tag","content":"qzmq"}],["$","meta","22",{"property":"article:tag","content":"post-quantum"}],["$","meta","23",{"property":"article:tag","content":"transport"}],["$","meta","24",{"property":"article:tag","content":"kdf"}],["$","meta","25",{"property":"article:tag","content":"key-schedule"}],["$","meta","26",{"property":"article:tag","content":"protocol-design"}],["$","meta","27",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","28",{"name":"twitter:site","content":"@hanzoai"}],["$","meta","29",{"name":"twitter:creator","content":"@hanzoai"}],["$","meta","30",{"name":"twitter:title","content":"QZMQ: A Post-Quantum Transport Protocol"}],["$","meta","31",{"name":"twitter:description","content":"QZMQ key schedule: HKDF-labeled QZMQ-v1-Handshake, client/server key+IV derivation, exporter secret, key ratcheting, 0-RTT early data, resumption secrets, and key usage budgets. Why a custom PQ transport."}],["$","meta","32",{"name":"twitter:image","content":"https://blog.hanzo.ai/blog/2024-04-10-qzmq-protocol/opengraph-image"}]],"error":null,"digest":"$undefined"}
15:{"metadata":"$d:metadata","error":null,"digest":"$undefined"}
