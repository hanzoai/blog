<!DOCTYPE html><html lang="en" class="__variable_245d8d __variable_97c177 antialiased"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/27834908180db20f-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/78fec81b34c4a365.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/45441016e214994e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-19293e76a0797e5c.js"/><script src="/_next/static/chunks/8b8ad143-e83b7b49f5b24ad0.js" async=""></script><script src="/_next/static/chunks/766-52c0c652dbe24189.js" async=""></script><script src="/_next/static/chunks/main-app-e8025b732b0b8d44.js" async=""></script><script src="/_next/static/chunks/cd24890f-00c67ea9d0bbf445.js" async=""></script><script src="/_next/static/chunks/933-166e0fcc9496c98f.js" async=""></script><script src="/_next/static/chunks/app/layout-d687a3a56998d23e.js" async=""></script><script src="/_next/static/chunks/771-2096a43097a1ac56.js" async=""></script><script src="/_next/static/chunks/698-980099c394b58d6f.js" async=""></script><script src="/_next/static/chunks/218-3bb2d990159730f8.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js" async=""></script><meta name="next-size-adjust" content=""/><meta name="theme-color" content="black"/><title>Building the Recommendation Engine: item2vec and the Cold Start Problem - Hanzo Blog</title><meta name="description" content="How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users."/><link rel="author" href="https://hanzo.blog"/><meta name="author" content="Zach Kelling"/><meta name="keywords" content="Building the Recommendation Engine: item2vec and the Cold Start Problem,recommendations,machine-learning,collaborative-filtering,item2vec,commerce,Hanzo AI,Blog,AI Research,Infrastructure"/><meta name="creator" content="Zach Kelling"/><meta name="publisher" content="Hanzo AI"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://hanzo.blog/blog/2015-08-20-recommendation-engine"/><meta property="og:title" content="Building the Recommendation Engine: item2vec and the Cold Start Problem"/><meta property="og:description" content="How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users."/><meta property="og:url" content="https://hanzo.blog/blog/2015-08-20-recommendation-engine"/><meta property="og:site_name" content="Hanzo Blog"/><meta property="og:image" content="https://hanzo.blog/blog/2015-08-20-recommendation-engine/opengraph-image"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Building the Recommendation Engine: item2vec and the Cold Start Problem"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2015-08-20"/><meta property="article:author" content="Zach Kelling"/><meta property="article:tag" content="recommendations"/><meta property="article:tag" content="machine-learning"/><meta property="article:tag" content="collaborative-filtering"/><meta property="article:tag" content="item2vec"/><meta property="article:tag" content="commerce"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@hanzoai"/><meta name="twitter:creator" content="@hanzoai"/><meta name="twitter:title" content="Building the Recommendation Engine: item2vec and the Cold Start Problem"/><meta name="twitter:description" content="How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users."/><meta name="twitter:image" content="https://hanzo.blog/blog/2015-08-20-recommendation-engine/opengraph-image"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><script>((e,t,r,n,i,o,a,s)=>{let l=document.documentElement,u=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&o?i.map(e=>o[e]||e):i;r?(l.classList.remove(...n),l.classList.add(o&&o[t]?o[t]:t)):l.setAttribute(e,t)}),r=t,s&&u.includes(r)&&(l.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","dark",null,["light","dark"],null,true,true)</script><header class="border-b border-border/50 px-6 py-4 sticky top-0 z-20 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60"><div class="max-w-5xl mx-auto flex items-center justify-between"><a href="https://hanzo.ai" class="flex items-center gap-2 text-foreground hover:opacity-80 transition-opacity"><img alt="Hanzo" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="dark:invert-0 invert" style="color:transparent" src="/hanzo-logo.svg"/><span class="font-semibold text-base tracking-tight">hanzo</span><span class="text-muted-foreground text-sm">/ blog</span></a><nav class="flex items-center gap-4 text-sm text-muted-foreground"><a href="https://hanzo.ai" class="hover:text-foreground transition-colors">hanzo.ai</a><a href="https://blog.zoo.ngo" class="hover:text-foreground transition-colors hidden sm:block">zoo</a><a href="https://zenlm.org/blog" class="hover:text-foreground transition-colors hidden sm:block">zen</a><a href="https://zeekay.blog" class="hover:text-foreground transition-colors hidden sm:block">zeekay</a><a href="https://discord.gg/hanzo" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border text-foreground hover:bg-accent transition-all text-sm font-medium"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle h-3.5 w-3.5" aria-hidden="true"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg>Discord</a></nav></div></header><div class="min-h-screen bg-background relative"><div class="absolute top-0 left-0 z-0 w-full h-[200px] [mask-image:linear-gradient(to_top,transparent_25%,black_95%)]"><div class="absolute top-0 left-0 size-full"><canvas class="pointer-events-none" style="width:0;height:0"></canvas></div></div><div class="space-y-4 border-b border-border relative z-10"><div class="max-w-7xl mx-auto flex flex-col gap-6 p-6"><div class="flex flex-wrap items-center gap-3 gap-y-5 text-sm text-muted-foreground"><a class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[&gt;svg]:px-3 h-6 w-6" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left w-4 h-4" aria-hidden="true"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg><span class="sr-only">Back to all articles</span></a><div class="flex flex-wrap gap-3 text-muted-foreground"><span class="h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center">recommendations</span><span class="h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center">machine-learning</span><span class="h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center">collaborative-filtering</span><span class="h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center">item2vec</span><span class="h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center">commerce</span></div><time class="font-medium text-muted-foreground">August 19, 2015</time></div><h1 class="text-4xl md:text-5xl lg:text-6xl font-medium tracking-tighter text-balance">Building the Recommendation Engine: item2vec and the Cold Start Problem</h1><p class="text-muted-foreground max-w-4xl md:text-lg md:text-balance">How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users.</p></div></div><div class="flex divide-x divide-border relative max-w-7xl mx-auto px-4 md:px-0 z-10"><div class="absolute max-w-7xl mx-auto left-1/2 -translate-x-1/2 w-[calc(100%-2rem)] lg:w-full h-full border-x border-border p-0 pointer-events-none"></div><main class="w-full p-0 overflow-hidden"><div class="p-6 lg:p-10"><div class="prose dark:prose-invert max-w-none prose-headings:scroll-mt-8 prose-headings:font-semibold prose-a:no-underline prose-headings:tracking-tight prose-headings:text-balance prose-p:tracking-tight prose-p:text-balance prose-lg"><div class="prose"><h1 id="building-the-recommendation-engine-item2vec-and-the-cold-start-problem" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">Building the Recommendation Engine: item2vec and the Cold Start Problem<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h1>
<p>The recommendation engine we wrote in 2015 was the most technically interesting thing we built that year. This is the honest account of how it worked, what it got wrong first, and how we fixed it.</p>
<h2 id="why-collaborative-filtering-is-the-right-starting-point" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">Why Collaborative Filtering Is The Right Starting Point<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>Collaborative filtering is the classic approach: users who bought X also bought Y. You build a user-item matrix (rows are users, columns are products, values are purchase or click events), factor it using SVD or ALS, and generate recommendations from the latent factors.</p>
<p>The math is well-understood. The Python implementation using scikit-learn or scipy&#x27;s sparse matrix tools is not difficult. The results are interpretable — &quot;customers who bought this also bought that&quot; has clear business logic behind it that merchandisers understand.</p>
<p>We had been running a simple version since 2014 based on item-item co-occurrence: count how often items appear together in the same order, normalize by total frequency, return the top-N co-occurring items. This was not a machine learning model; it was a frequency table. It worked surprisingly well for popular products. It failed completely for everything else.</p>
<h2 id="item2vec-treating-products-like-words" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">item2vec: Treating Products Like Words<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>In early 2015 we adopted item2vec, which had been published by Barkan and Koenigstein at Microsoft in 2016 — actually, the idea was circulating earlier in applied ML circles, derived directly from word2vec (Mikolov et al., 2013).</p>
<p>The core insight: word2vec learns word embeddings by training a neural network to predict context words given a center word in a sentence. The embeddings capture semantic similarity — words that appear in similar contexts end up close in vector space. item2vec applies the same approach to purchase sequences: train a skip-gram model where each &quot;sentence&quot; is an order (the set of items purchased together), and items that co-occur frequently in orders end up close in embedding space.</p>
<p>The practical result was a 128-dimensional embedding for each product. Recommendation became nearest-neighbor search in that embedding space.</p>
<p>The improvement over co-occurrence counting was significant. The embedding captured transitive relationships — if A and B frequently co-occur, and B and C frequently co-occur, A and C end up relatively close even without direct co-occurrence. The old frequency table missed these.</p>
<h2 id="the-cold-start-problem" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">The Cold Start Problem<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>Item embeddings require purchase history. A new product has no purchase history. A new user has no purchase history. This is the cold start problem, and it has two distinct variants.</p>
<p><strong>New item cold start.</strong> When a product is first listed, it has zero purchase events. The embedding model has nothing to learn from. Our initial solution was embarrassing: new products returned a global bestseller list as recommendations.</p>
<p>The fix was content-based bootstrapping. We had product attributes — category, price range, brand, tags — and we had embeddings for existing products with those same attributes. A new product could be initialized at the centroid of existing products that shared its key attributes. A new <code>running-shoes</code> product in the <code>$80-120</code> price range would start with an embedding averaged from existing products in that category and price range. This was not accurate but it was meaningfully better than a global bestseller list.</p>
<p><strong>New user cold start.</strong> A new user has no purchase history. For anonymous sessions we used the current session&#x27;s browse events: items viewed in the current session were treated as implicit signals. The session embedding was computed as the average of the viewed item embeddings, and recommendations were nearest neighbors to that session embedding.</p>
<p>For logged-in new users who had not yet purchased, we used a hybrid: 70% session-based, 30% demographic-based (if age and location were available from account creation).</p>
<h2 id="the-training-pipeline" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">The Training Pipeline<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>Training ran nightly. The pipeline was:</p>
<ol>
<li>Pull all order events from the last 90 days (a sliding window)</li>
<li>Build item sequences (items in the same order form a sequence)</li>
<li>Train skip-gram model using gensim&#x27;s Word2Vec implementation</li>
<li>Push new embeddings to Redis as a hash of <code>item_id -&gt; embedding_vector</code></li>
<li>Rebuild the k-NN index (we used an approximate nearest neighbor index — Annoy at the time)</li>
<li>Swap the index file atomically</li>
</ol>
<p>The nightly cadence was a constraint of the training time — about 90 minutes on the hardware we had in 2015. For fast-moving catalogs this was a lag we eventually needed to address, but for most commerce clients whose catalogs changed on weekly or monthly cycles, nightly was sufficient.</p>
<h2 id="evaluation" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">Evaluation<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>The offline evaluation metric was precision@10: what fraction of the 10 recommended items appeared in the user&#x27;s subsequent purchases. This was a retrospective measure — hold out the last purchase event, see if the recommendations would have surfaced it.</p>
<p>Our item2vec model achieved about 0.14 precision@10 on the held-out evaluation set. The co-occurrence baseline was 0.08. The bestseller global fallback was 0.03.</p>
<p>More meaningful: the online A/B test showed 18% lift in add-to-cart rate from the recommendation widget on product pages. That number held up after the novelty correction.</p>
<h2 id="what-we-did-not-build" class="group relative scroll-mt-20 cursor-pointer hover:text-muted-foreground transition-colors duration-200 flex items-center gap-2" title="Click to copy link to this section">What We Did Not Build<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex-shrink-0" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></h2>
<p>Contextual bandits for ranking. We had a retrieval model (k-NN in embedding space) but no sophisticated re-ranking step. The top-N by cosine similarity was what we returned. A bandit or a learning-to-rank model would have improved performance further, but the lift from the embedding approach alone was sufficient to justify shipping it.</p>
<p>That work came in 2016.</p>
<hr/>
<p><em>Hanzo&#x27;s recommendation engine shipped in Q3 2015. item2vec embeddings replaced the co-occurrence frequency table and delivered an 18% lift in add-to-cart rate. Cold start handling was added in the same quarter.</em></p></div></div></div><div class="mt-10"><section class="border-t border-border p-0"><div class="p-6 lg:p-10"><h2 class="text-2xl font-medium mb-8">Read more</h2><div class="flex flex-col gap-8"><a class="group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer" href="/blog/2015-04-18-collab-filtering"><div class="space-y-2 flex-1 col-span-1 lg:col-span-8"><h3 class="text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2">Collaborative Filtering at Commerce Scale: v1.0 of the Recommendation Engine</h3><p class="text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4">The first version of the Hanzo recommendation engine used matrix factorization to find latent preference signals in purchase data. Here&#x27;s how we built it.</p><time class="block text-xs font-medium text-muted-foreground">April 17, 2015</time></div></a><a class="group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer" href="/blog/2018-09-01-ml-analytics-paper"><div class="space-y-2 flex-1 col-span-1 lg:col-span-8"><h3 class="text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2">847 Features, 0.89 AUC: ML for Commerce Analytics</h3><p class="text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4">The ML Analytics paper, September 2018: 847-feature engineering pipeline, 0.89 AUC purchase prediction, 0.84 AUC churn prediction, modified k-means with behavioral embeddings, 2.3x marketing ROI, 50M events/day.</p><time class="block text-xs font-medium text-muted-foreground">August 31, 2018</time></div></a><a class="group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer" href="/blog/2018-07-15-hanzo-ml-v2"><div class="space-y-2 flex-1 col-span-1 lg:col-span-8"><h3 class="text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2">Hanzo ML v2: The Year the Models Actually Got Good</h3><p class="text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4">In 2018, the Hanzo ML stack crossed a threshold — the models were better than what clients could build in-house, not just faster. The shift from &#x27;convenient AI&#x27; to &#x27;essential AI&#x27; changed our product positioning.</p><time class="block text-xs font-medium text-muted-foreground">July 14, 2018</time></div></a></div></div></section></div></main><aside class="hidden lg:block w-[350px] flex-shrink-0 p-6 lg:p-10 bg-muted/60 dark:bg-muted/20"><div class="sticky top-20 space-y-8"><div class="flex items-start gap-2"><div class="flex-1"><h3 class="text-sm tracking-tight text-balance font-semibold">Zach Kelling</h3></div></div><div class="border border-border rounded-lg p-6 bg-card"></div></div></aside></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R2nnelb»" data-state="closed" class="lg:hidden fixed bottom-6 right-6 z-50 bg-primary text-primary-foreground p-3 rounded-full shadow-lg hover:bg-primary/90 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list" aria-hidden="true"><path d="M3 12h.01"></path><path d="M3 18h.01"></path><path d="M3 6h.01"></path><path d="M8 12h13"></path><path d="M8 18h13"></path><path d="M8 6h13"></path></svg></button></div><!--$--><!--/$--><footer class="border-t border-border/50 px-6 py-6 mt-auto"><div class="max-w-5xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-muted-foreground"><div class="flex items-center gap-2"><img alt="Hanzo" loading="lazy" width="16" height="16" decoding="async" data-nimg="1" class="dark:invert-0 invert opacity-50" style="color:transparent" src="/hanzo-logo.svg"/><span>© 2025 Hanzo AI, Inc. Techstars &#x27;17.</span></div><div class="flex items-center gap-4"><a href="https://hanzo.ai/privacy" class="hover:text-foreground transition-colors">Privacy</a><a href="https://hanzo.ai/terms" class="hover:text-foreground transition-colors">Terms</a><a href="https://blog.zoo.ngo" class="hover:text-foreground transition-colors hidden sm:block">zoo blog</a><a href="https://zenlm.org/blog" class="hover:text-foreground transition-colors hidden sm:block">zen blog</a><a href="https://zeekay.blog" class="hover:text-foreground transition-colors hidden sm:block">zeekay.blog</a><a href="https://github.com/hanzoai" target="_blank" rel="noopener noreferrer" class="hover:text-foreground transition-colors">GitHub</a></div></div></footer><script src="/_next/static/chunks/webpack-19293e76a0797e5c.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[861,[\"803\",\"static/chunks/cd24890f-00c67ea9d0bbf445.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"177\",\"static/chunks/app/layout-d687a3a56998d23e.js\"],\"PostHogProvider\"]\n3:I[2710,[\"803\",\"static/chunks/cd24890f-00c67ea9d0bbf445.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"177\",\"static/chunks/app/layout-d687a3a56998d23e.js\"],\"ThemeProvider\"]\n4:I[9933,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"Image\"]\n5:I[3977,[],\"\"]\n6:I[8765,[],\"\"]\n7:I[4526,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"FlickeringGrid\"]\n8:I[1964,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"\"]\na:I[2463,[],\"OutletBoundary\"]\nd:I[373,[],\"AsyncMetadataOutlet\"]\nf:I[2463,[],\"ViewportBoundary\"]\n11:I[2463,[],\"MetadataBoundary\"]\n13:I[680,[],\"\"]\n:HL[\"/_next/static/media/27834908180db20f-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/78fec81b34c4a365.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/45441016e214994e.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"yeRLKKIdrV-2cpcPU6Jw-\",\"p\":\"\",\"c\":[\"\",\"blog\",\"2015-08-20-recommendation-engine\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"2015-08-20-recommendation-engine\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/45441016e214994e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_245d8d __variable_97c177 antialiased\",\"suppressHydrationWarning\":true,\"children\":[\"$undefined\",[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"attribute\":\"class\",\"defaultTheme\":\"dark\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[[\"$\",\"header\",null,{\"className\":\"border-b border-border/50 px-6 py-4 sticky top-0 z-20 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-5xl mx-auto flex items-center justify-between\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://hanzo.ai\",\"className\":\"flex items-center gap-2 text-foreground hover:opacity-80 transition-opacity\",\"children\":[[\"$\",\"$L4\",null,{\"src\":\"/hanzo-logo.svg\",\"alt\":\"Hanzo\",\"width\":20,\"height\":20,\"className\":\"dark:invert-0 invert\"}],[\"$\",\"span\",null,{\"className\":\"font-semibold text-base tracking-tight\",\"children\":\"hanzo\"}],[\"$\",\"span\",null,{\"className\":\"text-muted-foreground text-sm\",\"children\":\"/ blog\"}]]}],[\"$\",\"nav\",null,{\"className\":\"flex items-center gap-4 text-sm text-muted-foreground\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://hanzo.ai\",\"className\":\"hover:text-foreground transition-colors\",\"children\":\"hanzo.ai\"}],[\"$\",\"a\",null,{\"href\":\"https://blog.zoo.ngo\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zoo\"}],[\"$\",\"a\",null,{\"href\":\"https://zenlm.org/blog\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zen\"}],[\"$\",\"a\",null,{\"href\":\"https://zeekay.blog\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zeekay\"}],[\"$\",\"a\",null,{\"href\":\"https://discord.gg/hanzo\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border text-foreground hover:bg-accent transition-all text-sm font-medium\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-message-circle h-3.5 w-3.5\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"vv11sd\",{\"d\":\"M7.9 20A9 9 0 1 0 4 16.1L2 22Z\"}],\"$undefined\"]}],\"Discord\"]}]]}]]}]}],[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background flex items-center justify-center w-full z-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute top-0 left-0 z-0 w-full h-[500px] [mask-image:linear-gradient(to_top,transparent_25%,black_95%)]\",\"children\":[\"$\",\"$L7\",null,{\"className\":\"absolute top-0 left-0 size-full\",\"squareSize\":4,\"gridGap\":6,\"color\":\"#6B7280\",\"maxOpacity\":0.5,\"flickerChance\":0.1}]}],[\"$\",\"div\",null,{\"className\":\"text-center flex flex-col gap-4 max-w-xs mx-auto relative\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-8xl font-mono font-bold drop-shadow-lg text-primary\",\"children\":\"404\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground text-base leading-relaxed text-center tracking-tight text-balance\",\"children\":\"Sorry, we couldn't find the page you're looking for. The page might have been moved, deleted, or you entered the wrong URL.\"}],[\"$\",\"$L8\",null,{\"href\":\"/\",\"children\":\"Back to Home\",\"className\":\"inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [\u0026_svg]:pointer-events-none [\u0026_svg:not([class*='size-'])]:size-4 shrink-0 [\u0026_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 px-4 py-2 has-[\u003esvg]:px-3 w-full rounded-lg h-9 drop-shadow-lg\",\"ref\":null}]]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"footer\",null,{\"className\":\"border-t border-border/50 px-6 py-6 mt-auto\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-5xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-muted-foreground\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2\",\"children\":[[\"$\",\"$L4\",null,{\"src\":\"/hanzo-logo.svg\",\"alt\":\"Hanzo\",\"width\":16,\"height\":16,\"className\":\"dark:invert-0 invert opacity-50\"}],[\"$\",\"span\",null,{\"children\":\"© 2025 Hanzo AI, Inc. Techstars '17.\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-4\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://hanzo.ai/privacy\",\"className\":\"hover:text-foreground transition-colors\",\"children\":\"Privacy\"}],[\"$\",\"a\",null,{\"href\":\"https://hanzo.ai/terms\",\"className\":\"hover:text-foreground transition-colors\",\"children\":\"Terms\"}],[\"$\",\"a\",null,{\"href\":\"https://blog.zoo.ngo\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zoo blog\"}],[\"$\",\"a\",null,{\"href\":\"https://zenlm.org/blog\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zen blog\"}],[\"$\",\"a\",null,{\"href\":\"https://zeekay.blog\",\"className\":\"hover:text-foreground transition-colors hidden sm:block\",\"children\":\"zeekay.blog\"}],[\"$\",\"a\",null,{\"href\":\"https://github.com/hanzoai\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-foreground transition-colors\",\"children\":\"GitHub\"}]]}]]}]}]]}]}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2015-08-20-recommendation-engine\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L6\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L9\",null,[\"$\",\"$La\",null,{\"children\":[\"$Lb\",\"$Lc\",[\"$\",\"$Ld\",null,{\"promise\":\"$@e\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"PlP7Xn_qZeIuKYWqRJVmlv\",{\"children\":[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$L11\",null,{\"children\":\"$L12\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$13\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:\"$Sreact.suspense\"\n15:I[373,[],\"AsyncMetadata\"]\n17:I[9048,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"HashScrollHandler\"]\n18:I[4170,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"CopyHeader\"]\n19:I[9372,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"TableOfContents\"]\n1a:I[1413,[\"771\",\"static/chunks/771-2096a43097a1ac56.js\",\"933\",\"static/chunks/933-166e0fcc9496c98f.js\",\"698\",\"static/chunks/698-980099c394b58d6f.js\",\"218\",\"static/chunks/218-3bb2d990159730f8.js\",\"953\",\"static/chunks/app/blog/%5Bslug%5D/page-b595d014fe271b46.js\"],\"MobileTableOfContents\"]\n12:[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$14\",null,{\"fallback\":null,\"children\":[\"$\",\"$L15\",null,{\"promise\":\"$@16\"}]}]}]\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background relative\",\"children\":[[\"$\",\"$L17\",null,{}],[\"$\",\"div\",null,{\"className\":\"absolute top-0 left-0 z-0 w-full h-[200px] [mask-image:linear-gradient(to_top,transparent_25%,black_95%)]\",\"children\":[\"$\",\"$L7\",null,{\"className\":\"absolute top-0 left-0 size-full\",\"squareSize\":4,\"gridGap\":6,\"color\":\"#6B7280\",\"maxOpacity\":0.2,\"flickerChance\":0.05}]}],[\"$\",\"div\",null,{\"className\":\"space-y-4 border-b border-border relative z-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto flex flex-col gap-6 p-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-3 gap-y-5 text-sm text-muted-foreground\",\"children\":[[\"$\",\"$L8\",null,{\"href\":\"/\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-arrow-left w-4 h-4\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1l729n\",{\"d\":\"m12 19-7-7 7-7\"}],[\"$\",\"path\",\"x3x0zl\",{\"d\":\"M19 12H5\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"Back to all articles\"}]],\"className\":\"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [\u0026_svg]:pointer-events-none [\u0026_svg:not([class*='size-'])]:size-4 shrink-0 [\u0026_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 px-4 py-2 has-[\u003esvg]:px-3 h-6 w-6\",\"ref\":null}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-3 text-muted-foreground\",\"children\":[[\"$\",\"span\",\"recommendations\",{\"className\":\"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center\",\"children\":\"recommendations\"}],[\"$\",\"span\",\"machine-learning\",{\"className\":\"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center\",\"children\":\"machine-learning\"}],[\"$\",\"span\",\"collaborative-filtering\",{\"className\":\"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center\",\"children\":\"collaborative-filtering\"}],[\"$\",\"span\",\"item2vec\",{\"className\":\"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center\",\"children\":\"item2vec\"}],[\"$\",\"span\",\"commerce\",{\"className\":\"h-6 w-fit px-3 text-sm font-medium bg-muted text-muted-foreground rounded-md border flex items-center justify-center\",\"children\":\"commerce\"}]]}],[\"$\",\"time\",null,{\"className\":\"font-medium text-muted-foreground\",\"children\":\"August 19, 2015\"}]]}],[\"$\",\"h1\",null,{\"className\":\"text-4xl md:text-5xl lg:text-6xl font-medium tracking-tighter text-balance\",\"children\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground max-w-4xl md:text-lg md:text-balance\",\"children\":\"How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users.\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex divide-x divide-border relative max-w-7xl mx-auto px-4 md:px-0 z-10\",\"children\":[[\"$\",\"div\",null,{\"className\":\"absolute max-w-7xl mx-auto left-1/2 -translate-x-1/2 w-[calc(100%-2rem)] lg:w-full h-full border-x border-border p-0 pointer-events-none\"}],[\"$\",\"main\",null,{\"className\":\"w-full p-0 overflow-hidden\",\"children\":[null,[\"$\",\"div\",null,{\"className\":\"p-6 lg:p-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert max-w-none prose-headings:scroll-mt-8 prose-headings:font-semibold prose-a:no-underline prose-headings:tracking-tight prose-headings:text-balance prose-p:tracking-tight prose-p:text-balance prose-lg\",\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"children\":[[\"$\",\"$L18\",null,{\"level\":1,\"id\":\"building-the-recommendation-engine-item2vec-and-the-cold-start-problem\",\"children\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The recommendation engine we wrote in 2015 was the most technically interesting thing we built that year. This is the honest account of how it worked, what it got wrong first, and how we fixed it.\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"why-collaborative-filtering-is-the-right-starting-point\",\"children\":\"Why Collaborative Filtering Is The Right Starting Point\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Collaborative filtering is the classic approach: users who bought X also bought Y. You build a user-item matrix (rows are users, columns are products, values are purchase or click events), factor it using SVD or ALS, and generate recommendations from the latent factors.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The math is well-understood. The Python implementation using scikit-learn or scipy's sparse matrix tools is not difficult. The results are interpretable — \\\"customers who bought this also bought that\\\" has clear business logic behind it that merchandisers understand.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We had been running a simple version since 2014 based on item-item co-occurrence: count how often items appear together in the same order, normalize by total frequency, return the top-N co-occurring items. This was not a machine learning model; it was a frequency table. It worked surprisingly well for popular products. It failed completely for everything else.\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"item2vec-treating-products-like-words\",\"children\":\"item2vec: Treating Products Like Words\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In early 2015 we adopted item2vec, which had been published by Barkan and Koenigstein at Microsoft in 2016 — actually, the idea was circulating earlier in applied ML circles, derived directly from word2vec (Mikolov et al., 2013).\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The core insight: word2vec learns word embeddings by training a neural network to predict context words given a center word in a sentence. The embeddings capture semantic similarity — words that appear in similar contexts end up close in vector space. item2vec applies the same approach to purchase sequences: train a skip-gram model where each \\\"sentence\\\" is an order (the set of items purchased together), and items that co-occur frequently in orders end up close in embedding space.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The practical result was a 128-dimensional embedding for each product. Recommendation became nearest-neighbor search in that embedding space.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The improvement over co-occurrence counting was significant. The embedding captured transitive relationships — if A and B frequently co-occur, and B and C frequently co-occur, A and C end up relatively close even without direct co-occurrence. The old frequency table missed these.\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"the-cold-start-problem\",\"children\":\"The Cold Start Problem\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Item embeddings require purchase history. A new product has no purchase history. A new user has no purchase history. This is the cold start problem, and it has two distinct variants.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"New item cold start.\"}],\" When a product is first listed, it has zero purchase events. The embedding model has nothing to learn from. Our initial solution was embarrassing: new products returned a global bestseller list as recommendations.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The fix was content-based bootstrapping. We had product attributes — category, price range, brand, tags — and we had embeddings for existing products with those same attributes. A new product could be initialized at the centroid of existing products that shared its key attributes. A new \",[\"$\",\"code\",null,{\"children\":\"running-shoes\"}],\" product in the \",[\"$\",\"code\",null,{\"children\":\"$$80-120\"}],\" price range would start with an embedding averaged from existing products in that category and price range. This was not accurate but it was meaningfully better than a global bestseller list.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"New user cold start.\"}],\" A new user has no purchase history. For anonymous sessions we used the current session's browse events: items viewed in the current session were treated as implicit signals. The session embedding was computed as the average of the viewed item embeddings, and recommendations were nearest neighbors to that session embedding.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For logged-in new users who had not yet purchased, we used a hybrid: 70% session-based, 30% demographic-based (if age and location were available from account creation).\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"the-training-pipeline\",\"children\":\"The Training Pipeline\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Training ran nightly. The pipeline was:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Pull all order events from the last 90 days (a sliding window)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Build item sequences (items in the same order form a sequence)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Train skip-gram model using gensim's Word2Vec implementation\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Push new embeddings to Redis as a hash of \",[\"$\",\"code\",null,{\"children\":\"item_id -\u003e embedding_vector\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Rebuild the k-NN index (we used an approximate nearest neighbor index — Annoy at the time)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Swap the index file atomically\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The nightly cadence was a constraint of the training time — about 90 minutes on the hardware we had in 2015. For fast-moving catalogs this was a lag we eventually needed to address, but for most commerce clients whose catalogs changed on weekly or monthly cycles, nightly was sufficient.\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"evaluation\",\"children\":\"Evaluation\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The offline evaluation metric was precision@10: what fraction of the 10 recommended items appeared in the user's subsequent purchases. This was a retrospective measure — hold out the last purchase event, see if the recommendations would have surfaced it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Our item2vec model achieved about 0.14 precision@10 on the held-out evaluation set. The co-occurrence baseline was 0.08. The bestseller global fallback was 0.03.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"More meaningful: the online A/B test showed 18% lift in add-to-cart rate from the recommendation widget on product pages. That number held up after the novelty correction.\"}],\"\\n\",[\"$\",\"$L18\",null,{\"level\":2,\"id\":\"what-we-did-not-build\",\"children\":\"What We Did Not Build\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Contextual bandits for ranking. We had a retrieval model (k-NN in embedding space) but no sophisticated re-ranking step. The top-N by cosine similarity was what we returned. A bandit or a learning-to-rank model would have improved performance further, but the lift from the embedding approach alone was sufficient to justify shipping it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"That work came in 2016.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"em\",null,{\"children\":\"Hanzo's recommendation engine shipped in Q3 2015. item2vec embeddings replaced the co-occurrence frequency table and delivered an 18% lift in add-to-cart rate. Cold start handling was added in the same quarter.\"}]}]],\"className\":\"prose\"}]}]}],[\"$\",\"div\",null,{\"className\":\"mt-10\",\"children\":[\"$\",\"section\",null,{\"className\":\"border-t border-border p-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"p-6 lg:p-10\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-2xl font-medium mb-8\",\"children\":\"Read more\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-8\",\"children\":[[\"$\",\"$L8\",\"/blog/2015-04-18-collab-filtering\",{\"href\":\"/blog/2015-04-18-collab-filtering\",\"className\":\"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"space-y-2 flex-1 col-span-1 lg:col-span-8\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2\",\"children\":\"Collaborative Filtering at Commerce Scale: v1.0 of the Recommendation Engine\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4\",\"children\":\"The first version of the Hanzo recommendation engine used matrix factorization to find latent preference signals in purchase data. Here's how we built it.\"}],[\"$\",\"time\",null,{\"className\":\"block text-xs font-medium text-muted-foreground\",\"children\":\"April 17, 2015\"}]]}]]}],[\"$\",\"$L8\",\"/blog/2018-09-01-ml-analytics-paper\",{\"href\":\"/blog/2018-09-01-ml-analytics-paper\",\"className\":\"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"space-y-2 flex-1 col-span-1 lg:col-span-8\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2\",\"children\":\"847 Features, 0.89 AUC: ML for Commerce Analytics\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4\",\"children\":\"The ML Analytics paper, September 2018: 847-feature engineering pipeline, 0.89 AUC purchase prediction, 0.84 AUC churn prediction, modified k-means with behavioral embeddings, 2.3x marketing ROI, 50M events/day.\"}],[\"$\",\"time\",null,{\"className\":\"block text-xs font-medium text-muted-foreground\",\"children\":\"August 31, 2018\"}]]}]]}],[\"$\",\"$L8\",\"/blog/2018-07-15-hanzo-ml-v2\",{\"href\":\"/blog/2018-07-15-hanzo-ml-v2\",\"className\":\"group grid grid-cols-1 lg:grid-cols-12 items-center gap-4 cursor-pointer\",\"children\":[\"$undefined\",[\"$\",\"div\",null,{\"className\":\"space-y-2 flex-1 col-span-1 lg:col-span-8\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"text-lg group-hover:underline underline-offset-4 font-semibold text-card-foreground group-hover:text-primary transition-colors line-clamp-2\",\"children\":\"Hanzo ML v2: The Year the Models Actually Got Good\"}],[\"$\",\"p\",null,{\"className\":\"text-muted-foreground text-sm line-clamp-3 group-hover:underline underline-offset-4\",\"children\":\"In 2018, the Hanzo ML stack crossed a threshold — the models were better than what clients could build in-house, not just faster. The shift from 'convenient AI' to 'essential AI' changed our product positioning.\"}],[\"$\",\"time\",null,{\"className\":\"block text-xs font-medium text-muted-foreground\",\"children\":\"July 14, 2018\"}]]}]]}]]}]]}]}]}]]}],[\"$\",\"aside\",null,{\"className\":\"hidden lg:block w-[350px] flex-shrink-0 p-6 lg:p-10 bg-muted/60 dark:bg-muted/20\",\"children\":[\"$\",\"div\",null,{\"className\":\"sticky top-20 space-y-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-start gap-2\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex-1\",\"children\":[\"$\",\"h3\",null,{\"className\":\"text-sm tracking-tight text-balance font-semibold\",\"children\":\"Zach Kelling\"}]}]}],[\"$\",\"div\",null,{\"className\":\"border border-border rounded-lg p-6 bg-card\",\"children\":[\"$\",\"$L19\",null,{}]}]]}]}]]}],[\"$\",\"$L1a\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"c:null\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"2\",{\"name\":\"theme-color\",\"content\":\"black\"}]]\nb:null\n"])</script><script>self.__next_f.push([1,"e:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem - Hanzo Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"author\",\"href\":\"https://hanzo.blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"Zach Kelling\"}],[\"$\",\"meta\",\"4\",{\"name\":\"keywords\",\"content\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem,recommendations,machine-learning,collaborative-filtering,item2vec,commerce,Hanzo AI,Blog,AI Research,Infrastructure\"}],[\"$\",\"meta\",\"5\",{\"name\":\"creator\",\"content\":\"Zach Kelling\"}],[\"$\",\"meta\",\"6\",{\"name\":\"publisher\",\"content\":\"Hanzo AI\"}],[\"$\",\"meta\",\"7\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"8\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"9\",{\"rel\":\"canonical\",\"href\":\"https://hanzo.blog/blog/2015-08-20-recommendation-engine\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:title\",\"content\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:description\",\"content\":\"How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users.\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:url\",\"content\":\"https://hanzo.blog/blog/2015-08-20-recommendation-engine\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:site_name\",\"content\":\"Hanzo Blog\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image\",\"content\":\"https://hanzo.blog/blog/2015-08-20-recommendation-engine/opengraph-image\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"17\",{\"property\":\"og:image:alt\",\"content\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem\"}],[\"$\",\"meta\",\"18\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"19\",{\"property\":\"article:published_time\",\"content\":\"2015-08-20\"}],[\"$\",\"meta\",\"20\",{\"property\":\"article:author\",\"content\":\"Zach Kelling\"}],[\"$\",\"meta\",\"21\",{\"property\":\"article:tag\",\"content\":\"recommendations\"}],[\"$\",\"meta\",\"22\",{\"property\":\"article:tag\",\"content\":\"machine-learning\"}],[\"$\",\"meta\",\"23\",{\"property\":\"article:tag\",\"content\":\"collaborative-filtering\"}],[\"$\",\"meta\",\"24\",{\"property\":\"article:tag\",\"content\":\"item2vec\"}],[\"$\",\"meta\",\"25\",{\"property\":\"article:tag\",\"content\":\"commerce\"}],[\"$\",\"meta\",\"26\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"27\",{\"name\":\"twitter:site\",\"content\":\"@hanzoai\"}],[\"$\",\"meta\",\"28\",{\"name\":\"twitter:creator\",\"content\":\"@hanzoai\"}],[\"$\",\"meta\",\"29\",{\"name\":\"twitter:title\",\"content\":\"Building the Recommendation Engine: item2vec and the Cold Start Problem\"}],[\"$\",\"meta\",\"30\",{\"name\":\"twitter:description\",\"content\":\"How we built the product recommendation engine in 2015: from collaborative filtering to item embeddings to solving cold start for new products and new users.\"}],[\"$\",\"meta\",\"31\",{\"name\":\"twitter:image\",\"content\":\"https://hanzo.blog/blog/2015-08-20-recommendation-engine/opengraph-image\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"16:{\"metadata\":\"$e:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>