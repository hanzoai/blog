---
title: "Hexagram 18 — Gǔ: Refactoring Legacy Systems"
date: "2025-04-30"
author: "Hanzo AI"
tags: ["iching", "engineering", "refactoring", "legacy", "technical-debt", "cleanup"]
description: "Mountain above wind — wind trapped beneath the mountain, stirring up what has decayed. Gǔ is the work of repairing corruption. In software, this is the refactoring of legacy systems — the necessary, unglamorous work of cleaning up what has spoiled."
---

# ䷑ Gǔ — Work on What Is Spoiled: The Refactoring Problem

Mountain above, wind below. Wind trapped under a mountain — stagnant, circling, stirring up decay. The eighteenth hexagram is about the active work of repairing what has been corrupted through neglect. Gǔ explicitly names the source of the corruption: the errors of the father (the founders, the originators) must be corrected by the son (the inheritors).

This is not blame. It is observation: systems decay because the people who built them made decisions that were correct at the time but are wrong now. The inheritors' job is to fix this. The text says: great success through this work.

## What Makes Legacy Systems Hard

Legacy systems are not hard because the original developers were incompetent. They are hard because software is written against a specific set of requirements, at a specific scale, with specific tools available, by developers who had specific context. None of those things remain constant.

The authentication layer that was perfectly adequate for ten thousand users creates bottlenecks at ten million. The database schema that was designed for SQL Server 2005 doesn't express the concepts needed for the 2025 product. The JavaScript codebase that was written before TypeScript existed doesn't have the type safety that new developers expect and tools support.

The corruption is real but it is not moral failure. It is the natural result of time. The mountain has grown. The wind below can no longer circulate.

## The Three Types of Legacy Work

Not all legacy work is the same. It is worth naming the categories because they require different approaches:

**Performance debt**: The system works correctly but slowly. The fix is usually profiling + targeted optimization. This is the easiest category: the correctness properties are established, you are not changing behavior, only execution characteristics.

**Structural debt**: The system is correct but the structure makes change expensive. The data model has grown into a shape that is hard to query efficiently. The module boundaries are wrong — things that should be separate are coupled, things that should be together are scattered. The fix is refactoring: changing the internal structure without changing the external behavior. This requires tests to verify that behavior is preserved.

**Conceptual debt**: The system's fundamental model of the problem has become wrong. What was modeled as a "user" is now "organization with multiple users." What was modeled as a "product" now needs to be "product variant with configurable options." These changes require data migration, API versioning, and careful coordination with clients. They are the most expensive and most necessary.

## The Strangler Fig, Revisited

For large-scale structural or conceptual refactoring, the strangler fig pattern is the most reliable approach. The name comes from a type of fig tree that grows around a host tree, eventually replacing it entirely.

The engineering implementation: build the replacement system alongside the legacy system. Route new traffic to the replacement. Migrate existing data when possible, leaving legacy data in place when not. When all traffic has moved, decommission the legacy system.

The critical property: at no point is there a moment where neither system is working. The legacy system remains fully operational until the replacement is proven. The replacement is proven incrementally, under real traffic, not in a parallel environment.

Hanzo's migration from the original JavaScript commerce SDK to the TypeScript platform took 18 months using this pattern. Each module was rewritten, tested, and traffic was migrated module by module. The old SDK received bug fixes throughout. The result: zero migration incidents, clean deletion of 80,000 lines of legacy JavaScript.

## The Work That No One Wants

Gǔ describes work that is necessary but not celebrated. No one gets promoted for refactoring legacy code. No one demos the strangler fig migration at the all-hands meeting. The users don't notice — which is the point.

This is the work that keeps systems alive. The I-Ching says: great success through this work. Not because the work is glamorous but because without it, systems die. The wind trapped under the mountain eventually stops circulating entirely.

Do the work. Three days before, three days after — the text advises careful preparation and follow-through. This is not ceremonial. It is the reminder that refactoring requires both a plan (preparation) and validation (follow-through).

The corruption will not fix itself. Someone has to do the work. Great success awaits them.
